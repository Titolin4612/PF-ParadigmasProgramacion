@{
    ViewData["Title"] = "Catálogo de Cartas";
    // Las siguientes líneas asumen que tu controlador ya ha llamado a Baraja.CargarCartas()
    // y ha poblado ViewData con las listas de cartas.
    var cartasJuego = ViewData["CartasJuego"] as List<CL_ProyectoFinalPOO.Clases.CartaJuego> ?? new List<CL_ProyectoFinalPOO.Clases.CartaJuego>();
    var cartasPremio = ViewData["CartasPremio"] as List<CL_ProyectoFinalPOO.Clases.CartaPremio> ?? new List<CL_ProyectoFinalPOO.Clases.CartaPremio>();
    var cartasCastigo = ViewData["CartasCastigo"] as List<CL_ProyectoFinalPOO.Clases.CartaCastigo> ?? new List<CL_ProyectoFinalPOO.Clases.CartaCastigo>();
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw=="
      crossorigin="anonymous" referrerpolicy="no-referrer" />

<div class="catalog-game-container netflix-style">
    <div class="catalog-scroll-area-netflix">
        <h1 class="catalog-main-title-papyrus"><i class="fas fa-layer-group"></i>Baraja de cartas</h1>

        @if (ViewBag.Error != null)
        {
                <div class="papyrus-alert error-alert-papyrus">
                    <i class="fas fa-exclamation-triangle"></i> @ViewBag.Error
                </div>
        }
        else
        {
                <section class="card-gallery-section">
                    <h2><i class="fas fa-atlas"></i> Cartas de Juego</h2>
                @if (cartasJuego.Any())
                {
                            <div class="image-carousel-container">
                        @foreach (var carta in cartasJuego)
                        {
                                        <div class="card-poster-item" tabindex="0">
                                            <img src="@(string.IsNullOrEmpty(carta.ImagenUrl) ? "https://via.placeholder.com/200x280/444/888?text=" + System.Net.WebUtility.UrlEncode(carta.Nombre) : Url.Content("~/" + carta.ImagenUrl))"
                                                 alt="Ilustración de @carta.Nombre" class="card-poster-image" />
                                            <div class="card-hover-info type-juego-hover">
                                                <h3>@carta.Nombre</h3>
                                                <div class="hover-info-content">
                                                    <p><strong>Mitología:</strong> @carta.Mitologia</p>
                                                    <p><strong>Rareza:</strong> @carta.RarezaCarta</p>
                                                    <p class="description">@carta.Descripcion</p>
                                                </div>
                                                <div class="hover-info-footer">
                                                    <span>Puntos: <strong class="@(carta.ObtenerPuntos() >= 0 ? "points-positive-papyrus" : "points-negative-papyrus")">@carta.ObtenerPuntos()</strong></span>
                                                    <span class="badge-type">Juego</span>
                                                </div>
                                            </div>
                                        </div>
                        }
                            </div>
                }
                else
                {
                            <p class="no-cards-message-papyrus">El tomo de las Cartas de Juego yace vacío por el momento.</p>
                }
                </section>

                <section class="card-gallery-section">
                    <h2><i class="fas fa-magic"></i> Cartas de Premio</h2>
                @if (cartasPremio.Any())
                {
                            <div class="image-carousel-container">
                        @foreach (var carta in cartasPremio)
                        {
                                        <div class="card-poster-item" tabindex="0">
                                            <img src="@(string.IsNullOrEmpty(carta.ImagenUrl) ? "https://via.placeholder.com/200x280/c5a052/fff8e1?text=" + System.Net.WebUtility.UrlEncode(carta.Nombre) : Url.Content("~/" + carta.ImagenUrl))"
                                                 alt="Ilustración de @carta.Nombre" class="card-poster-image" />
                                            <div class="card-hover-info type-premio-hover">
                                                <h3>@carta.Nombre</h3>
                                                <div class="hover-info-content">
                                                    <p><strong>Mitología:</strong> @carta.Mitologia</p>
                                                    <p><strong>Bendición:</strong> @carta.Bendicion</p>
                                                    <p class="description">@carta.Descripcion</p>
                                                </div>
                                                <div class="hover-info-footer">
                                                    <span>Puntos: <strong class="points-positive-papyrus">@carta.ObtenerPuntos()</strong></span>
                                                    <span class="badge-type">Premio</span>
                                                </div>
                                            </div>
                                        </div>
                        }
                            </div>
                }
                else
                {
                            <p class="no-cards-message-papyrus">Las bendiciones divinas aún no se han manifestado en este tomo.</p>
                }
                </section>

                <section class="card-gallery-section">
                    <h2><i class="fas fa-skull"></i> Cartas de Castigo</h2>
                @if (cartasCastigo.Any())
                {
                            <div class="image-carousel-container">
                        @foreach (var carta in cartasCastigo)
                        {
                                        <div class="card-poster-item" tabindex="0">
                                            <img src="@(string.IsNullOrEmpty(carta.ImagenUrl) ? "https://via.placeholder.com/200x280/6a3838/d7ccc8?text=" + System.Net.WebUtility.UrlEncode(carta.Nombre) : Url.Content("~/" + carta.ImagenUrl))"
                                                 alt="Ilustración de @carta.Nombre" class="card-poster-image" />
                                            <div class="card-hover-info type-castigo-hover">
                                                <h3>@carta.Nombre</h3>
                                                <div class="hover-info-content">
                                                    <p><strong>Mitología:</strong> @carta.Mitologia</p>
                                                    <p><strong>Maleficio:</strong> @carta.Maleficio</p>
                                                    <p class="description">@carta.Descripcion</p>
                                                </div>
                                                <div class="hover-info-footer">
                                                    <span>Puntos: <strong class="points-negative-papyrus">@carta.ObtenerPuntos()</strong></span>
                                                    <span class="badge-type">Castigo</span>
                                                </div>
                                            </div>
                                        </div>
                        }
                            </div>
                }
                else
                {
                            <p class="no-cards-message-papyrus">Las sombras de las Cartas de Castigo permanecen ocultas.</p>
                }
                </section>
        }
        <div class="return-section-papyrus">
            <a href="javascript:history.back()" class="papyrus-button">
                <i class="fas fa-arrow-left"></i> Volver al Índice
            </a>
        </div>
    </div>
</div>

<style>
    /* === ESTILOS GENERALES === */
    html, body { /* Aplica a todas las páginas a menos que uses una clase específica en body como .catalog-active */
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: 'Georgia', serif;
        background-color: #1e1a27; /* Fondo oscuro general */
        overflow-x: hidden; /* Prevenir scroll horizontal general */
        color: #3a2e1f; /* Color de texto por defecto para el papiro */
    }

    body.catalog-page-active { 
        overflow-y: hidden; /* Solo ocultar scroll vertical en la página del catálogo */
    }

    .catalog-game-container.netflix-style {
        position: relative;
        width: 100%;
        height: 100vh;
        padding-top: 70px; /* ESPACIO PARA NAVBAR */
        padding-bottom: 20px;
        box-sizing: border-box;
        display: flex;
        justify-content: center;
        align-items: flex-start;
    }

    .catalog-scroll-area-netflix {
        background: rgba(245, 230, 202, 0.96);
        border: 2px solid #a07d5c;
        box-shadow: 0 5px 25px rgba(0,0,0,0.5), 0 0 8px #5a4a3c inset;
        padding: 25px 0; /* Padding vertical, horizontal se maneja en hijos */
        width: 100%;
        max-width: 1400px;
        height: calc(100vh - 90px); /* 70px para navbar + 20px para padding inferior */
        margin: 0 auto;
        border-radius: 8px;
        color: #3a2e1f;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .catalog-scroll-area-netflix::-webkit-scrollbar { width: 10px; }
    .catalog-scroll-area-netflix::-webkit-scrollbar-track { background: rgba(160, 125, 92, 0.15); border-radius: 5px;}
    .catalog-scroll-area-netflix::-webkit-scrollbar-thumb { background-color: #a07d5c; border-radius: 5px; border: 2px solid rgba(245, 230, 202, 0.96); }
    .catalog-scroll-area-netflix::-webkit-scrollbar-thumb:hover { background-color: #8c643c; }
    .catalog-scroll-area-netflix { scrollbar-width: thin; scrollbar-color: #a07d5c rgba(245, 230, 202, 0.96); }

    .catalog-main-title-papyrus {
        font-family: 'Cinzel Decorative', cursive; /* Asegúrate de importar esta fuente o tener un fallback */
        font-size: 2.3em;
        color: #800000;
        text-align: center;
        margin-bottom: 25px;
        margin-top: 0;
        padding: 0 20px; /* Padding para que no pegue a los bordes del papiro */
        text-shadow: 1px 1px 2px rgba(0,0,0,0.25);
    }
    .catalog-main-title-papyrus i { margin-right: 12px; color: #b87333; }

    .card-gallery-section {
        margin-bottom: 35px;
    }
    .card-gallery-section:last-of-type {
        margin-bottom: 15px;
    }
    .card-gallery-section h2 {
        font-family: 'Georgia', serif;
        font-size: 1.7em;
        color: #4a3b2c;
        margin-bottom: 18px;
        padding: 0 20px; /* Padding igual al del título principal para alineación */
        display: flex;
        align-items: center;
        border-bottom: 1px dashed #c1a57e;
        padding-bottom: 8px;
    }
    .card-gallery-section h2 i { margin-right: 10px; font-size: 0.9em; color: #8c643c; }

    .image-carousel-container {
        display: flex;
        overflow-x: auto;
        overflow-y: hidden;
        padding: 10px 20px; /* Padding igual al del título de sección */
        gap: 16px;
        scrollbar-width: none;
        -ms-overflow-style: none;
        margin-bottom: 10px;
    }
    .image-carousel-container::-webkit-scrollbar { display: none; }

    .card-poster-item {
        position: relative;
        min-width: 170px;
        max-width: 190px;
        aspect-ratio: 10 / 14; /* Proporción ~0.714, similar a cartas Magic/Pokemon */
        border-radius: 10px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.25);
        overflow: hidden; /* Importante para que el hover info no se desborde visualmente del poster base */
        cursor: pointer;
        transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid rgba(0,0,0,0.1);
        background-color: #ccc; /* Color de fondo mientras carga la imagen */
    }
    .card-poster-item:hover,
    .card-poster-item:focus-within {
        transform: scale(1.12);
        box-shadow: 0 6px 20px rgba(0,0,0,0.35);
        z-index: 10; /* Asegura que el poster escalado esté sobre otros posters */
    }

    .card-poster-image {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Cubre el área, puede recortar partes de la imagen si no coincide la proporción */
        display: block;
        border-radius: inherit; /* Hereda el radio del .card-poster-item */
    }

    .card-hover-info {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(30, 25, 35, 0.93); /* Fondo del hover, ajusta transparencia (0.0 a 1.0) */
        color: #f5e5c5;
        padding: 10px;
        box-sizing: border-box;
        border-radius: inherit;
        opacity: 0;
        visibility: hidden;
        transform: scale(0.9) translateY(15px); /* Inicia más pequeño y un poco abajo */
        transform-origin: center center; /* El escalado y transformación ocurre desde el centro */
        transition: opacity 0.2s ease-out, visibility 0s 0.2s, transform 0.2s ease-out;
        transition-delay: 0.08s;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        font-size: 0.8rem;
        line-height: 1.35;
        pointer-events: none; /* No interfiere con el hover del poster inicialmente */
        z-index: 11; /* Asegura que la info esté sobre la imagen del poster */
    }

    .card-poster-item:hover .card-hover-info,
    .card-poster-item:focus-within .card-hover-info {
        opacity: 1;
        visibility: visible;
        transform: scale(1) translateY(0);
        pointer-events: auto; /* Permite interactuar con el contenido del hover */
        transition-delay: 0.12s;
    }

    .card-hover-info h3 {
        font-family: 'Cinzel Decorative', cursive;
        font-size: 1em;
        margin: 0 0 6px 0;
        color: #ffd700;
        text-shadow: 1px 1px 1px rgba(0,0,0,0.6);
        line-height: 1.2;
        text-align: center;
        border-bottom: 1px solid rgba(255,215,0,0.15);
        padding-bottom: 4px;
    }

    .hover-info-content {
        flex-grow: 1;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: #ffd700 rgba(30, 25, 35, 0.5);
        padding-right: 4px;
        margin-bottom: 6px;
        max-height: 100px; /* Ajusta según la cantidad de texto esperada */
    }
    .hover-info-content::-webkit-scrollbar { width: 5px; }
    .hover-info-content::-webkit-scrollbar-track { background: rgba(30, 25, 35, 0.5); border-radius: 3px; }
    .hover-info-content::-webkit-scrollbar-thumb { background-color: #ffd700; border-radius: 3px; }

    .hover-info-content p { margin: 0 0 5px 0; }
    .hover-info-content p strong { color: #ffc078; }
    .hover-info-content p.description { font-style: italic; font-size: 0.92em; color: #e0d0b0; }

    .hover-info-footer {
        margin-top: auto;
        padding-top: 6px;
        border-top: 1px solid rgba(255, 215, 0, 0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.88em;
    }
    .hover-info-footer .badge-type {
        background-color: rgba(255, 215, 0, 0.1);
        color: #ffd700;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: normal;
        font-size: 0.9em;
    }
    .points-positive-papyrus { color: #90ee90; font-weight: bold; }
    .points-negative-papyrus { color: #f08080; font-weight: bold; }

    /* Opcional: Clases para diferenciar el hover-info por tipo de carta */
    .card-hover-info.type-juego-hover { /* background-color: rgba(30, 25, 35, 0.93); */ }
    .card-hover-info.type-premio-hover { /* background-color: rgba(35, 30, 25, 0.93); */ }
    .card-hover-info.type-castigo-hover { /* background-color: rgba(35, 25, 25, 0.93); */ }

    .no-cards-message-papyrus, .papyrus-alert {
        padding-left: 20px; /* Alineado con el padding de los títulos de sección */
        padding-right: 20px;
        margin-left: 0; /* Ya no necesita margen si el padre tiene padding */
        margin-right: 0;
    }
    .papyrus-alert { margin-bottom: 20px; } /* Espacio debajo de la alerta */
    .error-alert-papyrus {
        background-color: rgba(139, 0, 0, 0.1);
        color: #8B0000;
        border: 1px solid #8B0000;
    }

    .return-section-papyrus { margin-top: 25px; text-align: center; padding-bottom:15px; }
    .papyrus-button { /* Estilos del botón sin cambios significativos */
        display: inline-block;
        background: linear-gradient(to bottom, #a8886a, #8c643c);
        color: #f5f5dc; padding: 10px 20px; text-decoration: none;
        border-radius: 8px; font-weight: bold; font-size: 1em;
        transition: all 0.3s ease; border: 1px solid #604c38;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        text-transform: uppercase; letter-spacing: 0.5px;
    }
    .papyrus-button:hover {
        background: linear-gradient(to bottom, #8c643c, #70553a);
        color: #fff;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

</style>